(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,7233,e=>{"use strict";let t=(0,e.i(75254).default)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);e.s(["Plus",()=>t],7233)},27612,e=>{"use strict";let t=(0,e.i(75254).default)("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);e.s(["Trash2",()=>t],27612)},78916,e=>{"use strict";var t=e.i(17160);async function r(e,a={}){let{params:s,...i}=a,d=`http://localhost:3001${e}`;if(s){let e=new URLSearchParams;Object.entries(s).forEach(([t,r])=>{e.append(t,String(r))}),d+=`?${e.toString()}`}let l={"Content-Type":"application/json"};i.headers&&"object"==typeof i.headers&&Object.assign(l,i.headers);let n=(0,t.getToken)();n&&(l.Authorization=`Bearer ${n}`);let c=await fetch(d,{...i,headers:l});if(!c.ok)throw Error((await c.json().catch(()=>({}))).message||`API error: ${c.statusText}`);let o=c.headers.get("content-type");return o?.includes("application/json")?c.json():c}async function a(e,t){return r(e,{...t,method:"GET"})}async function s(e,t,a){return r(e,{...a,method:"PATCH",body:t?JSON.stringify(t):void 0})}async function i(e,t){return r(e,{...t,method:"DELETE"})}e.s(["del",()=>i,"get",()=>a,"patch",()=>s])},15384,e=>{"use strict";var t=e.i(43476),r=e.i(18566),a=e.i(71645),s=e.i(62324),i=e.i(78916),d=e.i(61911),l=e.i(7233),n=e.i(27612);function c(){let e=(0,r.useRouter)(),{user:c,isLoading:o}=(0,s.useAuth)(),[x,h]=(0,a.useState)([]),[g,u]=(0,a.useState)(!0),[m,p]=(0,a.useState)(null),[y,b]=(0,a.useState)(null);(0,a.useEffect)(()=>{if(!o){if(!c)return void e.push("/auth/signin");j()}},[o,c,e]);let j=async()=>{try{u(!0),p(null);let e=await i.get("/users");h(Array.isArray(e)?e:e.data||[])}catch(t){let e=t instanceof Error?t.message:"Erreur lors de la récupération des utilisateurs";p(e),console.error(e)}finally{u(!1)}},f=async(e,t)=>{try{b(e),await i.patch(`/users/${e}`,{role:t}),await j()}catch(e){alert(e instanceof Error?e.message:"Erreur lors de la mise à jour")}finally{b(null)}},k=async(e,t)=>{if(confirm(`\xcates-vous s\xfbr de vouloir supprimer l'utilisateur ${t} ?`))try{await i.del(`/users/${e}`),await j()}catch(e){alert(e instanceof Error?e.message:"Erreur lors de la suppression")}};return o||g?(0,t.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"}),(0,t.jsx)("p",{className:"mt-4 text-gray-600 dark:text-gray-400",children:"Chargement des utilisateurs..."})]})}):(0,t.jsxs)("div",{className:"space-y-8",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("div",{className:"w-12 h-12 bg-gradient-to-br from-orange-500 to-red-500 rounded-lg flex items-center justify-center text-white",children:(0,t.jsx)(d.Users,{className:"w-6 h-6"})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:"Gestion des utilisateurs"}),(0,t.jsx)("p",{className:"text-gray-600 dark:text-gray-400",children:"Gérer les rôles et permissions"})]})]}),(0,t.jsxs)("button",{className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[(0,t.jsx)(l.Plus,{className:"w-4 h-4"}),"Ajouter un utilisateur"]})]}),m&&(0,t.jsx)("div",{className:"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg p-4",children:(0,t.jsxs)("p",{className:"text-red-700 dark:text-red-300",children:["⚠️ ",m]})}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,t.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-6 border border-gray-200 dark:border-gray-700",children:[(0,t.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-2",children:"Total utilisateurs"}),(0,t.jsx)("p",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:x.length})]}),(0,t.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-6 border border-gray-200 dark:border-gray-700",children:[(0,t.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-2",children:"Admins"}),(0,t.jsx)("p",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:x.filter(e=>"ADMIN"===e.role).length})]}),(0,t.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-6 border border-gray-200 dark:border-gray-700",children:[(0,t.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-2",children:"Super Admins"}),(0,t.jsx)("p",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:x.filter(e=>"SUPER_ADMIN"===e.role).length})]})]}),(0,t.jsx)("div",{className:"bg-white dark:bg-gray-800 shadow-sm rounded-lg border border-gray-200 dark:border-gray-700 overflow-hidden",children:(0,t.jsx)("div",{className:"overflow-x-auto",children:(0,t.jsxs)("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-gray-700",children:[(0,t.jsx)("thead",{className:"bg-gray-50 dark:bg-gray-700/50",children:(0,t.jsxs)("tr",{children:[(0,t.jsx)("th",{className:"px-6 py-3 text-left text-xs font-semibold text-gray-900 dark:text-white uppercase tracking-wider",children:"Utilisateur"}),(0,t.jsx)("th",{className:"px-6 py-3 text-left text-xs font-semibold text-gray-900 dark:text-white uppercase tracking-wider",children:"Email"}),(0,t.jsx)("th",{className:"px-6 py-3 text-left text-xs font-semibold text-gray-900 dark:text-white uppercase tracking-wider",children:"Rôle"}),(0,t.jsx)("th",{className:"px-6 py-3 text-left text-xs font-semibold text-gray-900 dark:text-white uppercase tracking-wider",children:"Créé le"}),(0,t.jsx)("th",{className:"px-6 py-3 text-left text-xs font-semibold text-gray-900 dark:text-white uppercase tracking-wider",children:"Dernière connexion"}),(0,t.jsx)("th",{className:"px-6 py-3 text-right text-xs font-semibold text-gray-900 dark:text-white uppercase tracking-wider",children:"Actions"})]})}),(0,t.jsx)("tbody",{className:"divide-y divide-gray-200 dark:divide-gray-700",children:0===x.length?(0,t.jsx)("tr",{children:(0,t.jsx)("td",{colSpan:6,className:"px-6 py-12 text-center",children:(0,t.jsx)("p",{className:"text-gray-500 dark:text-gray-400",children:"Aucun utilisateur trouvé"})})}):x.map(e=>(0,t.jsxs)("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-700/50 transition-colors",children:[(0,t.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[e.image&&(0,t.jsx)("img",{src:e.image,alt:e.name||"User",className:"w-10 h-10 rounded-full object-cover"}),(0,t.jsx)("div",{children:(0,t.jsx)("div",{className:"text-sm font-medium text-gray-900 dark:text-white",children:e.name||"Sans nom"})})]})}),(0,t.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,t.jsx)("div",{className:"text-sm text-gray-600 dark:text-gray-300",children:e.email})}),(0,t.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap",children:[(0,t.jsxs)("select",{value:e.role,onChange:t=>f(e.id,t.target.value),disabled:y===e.id||e.id===c?.id,className:"text-sm border border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white rounded px-3 py-1.5 disabled:opacity-50 disabled:cursor-not-allowed",children:[(0,t.jsx)("option",{value:"USER",children:"User"}),(0,t.jsx)("option",{value:"ADMIN",children:"Admin"}),(0,t.jsx)("option",{value:"SUPER_ADMIN",children:"Super Admin"})]}),y===e.id&&(0,t.jsx)("span",{className:"ml-2 text-xs text-gray-500 dark:text-gray-400",children:"Mise à jour..."})]}),(0,t.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-600 dark:text-gray-400",children:new Date(e.createdAt).toLocaleDateString("fr-FR")}),(0,t.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-600 dark:text-gray-400",children:e.lastLoginAt?new Date(e.lastLoginAt).toLocaleDateString("fr-FR"):"-"}),(0,t.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-right",children:(0,t.jsxs)("button",{onClick:()=>k(e.id,e.email||"cet utilisateur"),disabled:e.id===c?.id,className:"inline-flex items-center gap-2 px-3 py-2 text-red-600 dark:text-red-400 hover:bg-red-50 dark:hover:bg-red-900/20 rounded transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:[(0,t.jsx)(n.Trash2,{className:"w-4 h-4"}),(0,t.jsx)("span",{className:"hidden sm:inline text-xs",children:"Supprimer"})]})})]},e.id))})]})})}),x.length>0&&(0,t.jsxs)("div",{className:"text-sm text-gray-600 dark:text-gray-400 bg-gray-50 dark:bg-gray-800 p-4 rounded-lg border border-gray-200 dark:border-gray-700",children:["Total: ",(0,t.jsx)("strong",{children:x.length})," utilisateur",x.length>1?"s":""]})]})}e.s(["default",()=>c])}]);