module.exports=[85630,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(70106);let e=(0,d.default)("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]),f=(0,d.default)("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]),g=(0,d.default)("CloudDownload",[["path",{d:"M12 13v8l-4-4",key:"1f5nwf"}],["path",{d:"m12 21 4-4",key:"1lfcce"}],["path",{d:"M4.393 15.269A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 2.436 8.284",key:"ui1hmy"}]]);var h=a.i(71987),i=a.i(4720);let j=(0,d.default)("Film",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M7 3v18",key:"bbkbws"}],["path",{d:"M3 7.5h4",key:"zfgn84"}],["path",{d:"M3 12h18",key:"1i2n21"}],["path",{d:"M3 16.5h4",key:"1230mu"}],["path",{d:"M17 3v18",key:"in4fa5"}],["path",{d:"M17 7.5h4",key:"myr1c1"}],["path",{d:"M17 16.5h4",key:"go4c1d"}]]);var k=a.i(33441);function l({media:a,selected:c,onSelect:d,onClick:e}){let f="image"===a.type;return(0,b.jsxs)("div",{className:`group relative aspect-square bg-gray-100 dark:bg-gray-800 rounded-lg overflow-hidden border-2 transition-all cursor-pointer
        ${c?"border-blue-500 ring-2 ring-blue-500 ring-opacity-50":"border-transparent hover:border-gray-300 dark:hover:border-gray-600"}`,onClick:()=>e?.(a),children:[f?(0,b.jsx)(h.default,{src:a.url,alt:a.filename,fill:!0,className:"object-cover",sizes:"(max-width: 768px) 50vw, (max-width: 1200px) 33vw, 20vw"}):(0,b.jsx)("div",{className:"w-full h-full flex items-center justify-center text-gray-400",children:"video"===a.type?(0,b.jsx)(j,{size:48}):(0,b.jsx)(i.FileText,{size:48})}),(0,b.jsx)("div",{className:"absolute inset-0 bg-black bg-opacity-0 group-hover:bg-opacity-30 transition-all flex flex-col justify-end p-2",children:(0,b.jsx)("p",{className:"text-white text-xs truncate opacity-0 group-hover:opacity-100 font-medium drop-shadow-md",children:a.filename})}),d&&(0,b.jsx)("div",{className:"absolute top-2 right-2 z-10",onClick:b=>{b.stopPropagation(),d(a)},children:(0,b.jsx)("div",{className:`w-6 h-6 rounded-full border-2 flex items-center justify-center transition-colors
            ${c?"bg-blue-500 border-blue-500 text-white":"bg-white/80 border-gray-300 text-transparent hover:border-blue-400"}`,children:(0,b.jsx)(k.Check,{size:14,strokeWidth:3})})})]})}let m=(0,d.default)("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);var n=a.i(33508);let o=(0,d.default)("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);function p({onUploadComplete:a}){let[d,e]=(0,c.useState)(!1),[f,g]=(0,c.useState)(!1),[h,i]=(0,c.useState)(null),j=(0,c.useRef)(null),k=async a=>{a.preventDefault(),e(!1),a.dataTransfer.files&&a.dataTransfer.files.length>0&&await p(Array.from(a.dataTransfer.files))},l=async a=>{a.target.files&&a.target.files.length>0&&await p(Array.from(a.target.files))},p=async b=>{g(!0),i(null);try{for(let c of b){let b=new FormData;b.append("file",c),b.append("folder","sifaka-media");let d=await fetch("/api/media",{method:"POST",body:b});if(!d.ok)throw Error(`Erreur lors de l'upload de ${c.name}`);let e=await d.json();a(e)}}catch(a){console.error(a),i(a.message||"Une erreur est survenue lors de l'upload")}finally{g(!1),j.current&&(j.current.value="")}};return(0,b.jsxs)("div",{className:"w-full",children:[(0,b.jsxs)("div",{className:`border-2 border-dashed rounded-lg p-8 text-center transition-colors cursor-pointer
          ${d?"border-blue-500 bg-blue-50 dark:bg-blue-900/20":"border-gray-300 dark:border-gray-700 hover:border-gray-400 dark:hover:border-gray-600"}
          ${f?"opacity-50 pointer-events-none":""}
        `,onDragOver:a=>{a.preventDefault(),e(!0)},onDragLeave:a=>{a.preventDefault(),e(!1)},onDrop:k,onClick:()=>j.current?.click(),children:[(0,b.jsx)("input",{type:"file",ref:j,className:"hidden",multiple:!0,accept:"image/*,video/*,application/pdf",onChange:l}),f?(0,b.jsxs)("div",{className:"flex flex-col items-center justify-center text-blue-600 dark:text-blue-400",children:[(0,b.jsx)(o,{className:"w-10 h-10 animate-spin mb-2"}),(0,b.jsx)("p",{className:"font-medium",children:"Upload en cours..."})]}):(0,b.jsxs)("div",{className:"flex flex-col items-center justify-center text-gray-500 dark:text-gray-400",children:[(0,b.jsx)(m,{className:"w-10 h-10 mb-2"}),(0,b.jsx)("p",{className:"font-medium text-gray-900 dark:text-gray-200",children:"Cliquez ou glissez des fichiers ici"}),(0,b.jsx)("p",{className:"text-sm mt-1",children:"Images, vidéos ou documents (max 5MB)"})]})]}),h&&(0,b.jsxs)("div",{className:"mt-2 p-3 bg-red-50 dark:bg-red-900/20 text-red-600 dark:text-red-400 rounded-md text-sm flex items-center justify-between",children:[(0,b.jsx)("span",{children:h}),(0,b.jsx)("button",{onClick:()=>i(null),className:"hover:text-red-800",children:(0,b.jsx)(n.X,{size:16})})]})]})}var q=a.i(14548),r=a.i(81560);let s=(0,d.default)("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]),t=(0,d.default)("ExternalLink",[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]]);function u({media:a,isOpen:d,onClose:e,onUpdate:f,onDelete:g}){let[k,l]=(0,c.useState)({title:a.title||"",alt:a.alt||"",description:a.description||"",tags:a.tags?.join(", ")||""}),[m,o]=(0,c.useState)(!1),[p,u]=(0,c.useState)(!1),[v,w]=(0,c.useState)(!1);if((0,c.useEffect)(()=>{l({title:a.title||"",alt:a.alt||"",description:a.description||"",tags:a.tags?.join(", ")||""})},[a]),!d)return null;let x=async()=>{o(!0);try{let b=k.tags.split(",").map(a=>a.trim()).filter(Boolean);await f(a.id,{...k,tags:b}),e()}catch(a){console.error("Error updating media:",a)}finally{o(!1)}},y=async()=>{if(confirm("Êtes-vous sûr de vouloir supprimer ce média ? Cette action est irréversible.")){u(!0);try{await g(a.id),e()}catch(a){console.error("Error deleting media:",a)}finally{u(!1)}}};return(0,b.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 backdrop-blur-sm p-4",children:(0,b.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-xl w-full max-w-4xl max-h-[90vh] overflow-hidden flex flex-col md:flex-row",children:[(0,b.jsx)("div",{className:"w-full md:w-1/2 bg-gray-100 dark:bg-gray-900 flex items-center justify-center p-4 relative min-h-[300px]",children:"image"===a.type?(0,b.jsx)("div",{className:"relative w-full h-full min-h-[300px]",children:(0,b.jsx)(h.default,{src:a.url,alt:a.alt||a.filename,fill:!0,className:"object-contain"})}):(0,b.jsxs)("div",{className:"text-gray-400 flex flex-col items-center",children:["video"===a.type?(0,b.jsx)(j,{size:64}):(0,b.jsx)(i.FileText,{size:64}),(0,b.jsx)("p",{className:"mt-4 text-sm font-medium",children:a.filename})]})}),(0,b.jsxs)("div",{className:"w-full md:w-1/2 flex flex-col h-full max-h-[90vh]",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between p-4 border-b dark:border-gray-700",children:[(0,b.jsx)("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Détails du média"}),(0,b.jsx)("button",{onClick:e,className:"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200",children:(0,b.jsx)(n.X,{size:20})})]}),(0,b.jsxs)("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",children:[(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4 text-sm text-gray-600 dark:text-gray-400 bg-gray-50 dark:bg-gray-900/50 p-3 rounded-lg",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("span",{className:"block text-xs uppercase text-gray-400",children:"Type"}),a.mimeType]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("span",{className:"block text-xs uppercase text-gray-400",children:"Taille"}),(a=>{if(0===a)return"0 B";let b=Math.floor(Math.log(a)/Math.log(1024));return parseFloat((a/Math.pow(1024,b)).toFixed(2))+" "+["B","KB","MB","GB"][b]})(a.size)]}),a.width&&(0,b.jsxs)("div",{children:[(0,b.jsx)("span",{className:"block text-xs uppercase text-gray-400",children:"Dimensions"}),a.width," x ",a.height]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("span",{className:"block text-xs uppercase text-gray-400",children:"Date"}),new Date(a.createdAt).toLocaleDateString()]})]}),(0,b.jsxs)("div",{className:"space-y-3",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Titre"}),(0,b.jsx)("input",{type:"text",value:k.title,onChange:a=>l({...k,title:a.target.value}),className:"w-full px-3 py-2 border rounded-md dark:bg-gray-700 dark:border-gray-600 dark:text-white focus:ring-2 focus:ring-blue-500"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Texte alternatif (Alt)"}),(0,b.jsx)("input",{type:"text",value:k.alt,onChange:a=>l({...k,alt:a.target.value}),className:"w-full px-3 py-2 border rounded-md dark:bg-gray-700 dark:border-gray-600 dark:text-white focus:ring-2 focus:ring-blue-500",placeholder:"Description pour l'accessibilité et le SEO"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Tags (séparés par des virgules)"}),(0,b.jsx)("input",{type:"text",value:k.tags,onChange:a=>l({...k,tags:a.target.value}),className:"w-full px-3 py-2 border rounded-md dark:bg-gray-700 dark:border-gray-600 dark:text-white focus:ring-2 focus:ring-blue-500",placeholder:"nature, baobab, madagascar"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Description"}),(0,b.jsx)("textarea",{value:k.description,onChange:a=>l({...k,description:a.target.value}),rows:3,className:"w-full px-3 py-2 border rounded-md dark:bg-gray-700 dark:border-gray-600 dark:text-white focus:ring-2 focus:ring-blue-500"})]})]}),(0,b.jsxs)("div",{className:"flex items-center gap-2 p-3 bg-gray-50 dark:bg-gray-900/50 rounded-lg border dark:border-gray-700",children:[(0,b.jsx)("input",{type:"text",readOnly:!0,value:a.url,className:"flex-1 bg-transparent text-sm text-gray-600 dark:text-gray-300 outline-none"}),(0,b.jsx)("button",{onClick:()=>{navigator.clipboard.writeText(a.url),w(!0),setTimeout(()=>w(!1),2e3)},className:"text-gray-500 hover:text-blue-600 dark:text-gray-400 dark:hover:text-blue-400",title:"Copier l'URL",children:v?(0,b.jsx)("span",{className:"text-green-500 text-xs font-bold",children:"Copié!"}):(0,b.jsx)(s,{size:16})}),(0,b.jsx)("a",{href:a.url,target:"_blank",rel:"noopener noreferrer",className:"text-gray-500 hover:text-blue-600 dark:text-gray-400 dark:hover:text-blue-400",title:"Ouvrir dans un nouvel onglet",children:(0,b.jsx)(t,{size:16})})]})]}),(0,b.jsxs)("div",{className:"p-4 border-t dark:border-gray-700 flex justify-between items-center bg-gray-50 dark:bg-gray-800",children:[(0,b.jsxs)("button",{onClick:y,disabled:p,className:"flex items-center gap-2 px-4 py-2 text-red-600 hover:bg-red-50 dark:hover:bg-red-900/20 rounded-md transition-colors disabled:opacity-50",children:[(0,b.jsx)(r.Trash2,{size:18}),(0,b.jsx)("span",{className:"hidden sm:inline",children:"Supprimer"})]}),(0,b.jsxs)("div",{className:"flex gap-3",children:[(0,b.jsx)("button",{onClick:e,className:"px-4 py-2 text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md transition-colors",children:"Annuler"}),(0,b.jsxs)("button",{onClick:x,disabled:m,className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white hover:bg-blue-700 rounded-md transition-colors disabled:opacity-50",children:[(0,b.jsx)(q.Save,{size:18}),(0,b.jsx)("span",{children:m?"Enregistrement...":"Enregistrer"})]})]})]})]})]})})}function v({onSelect:a,selectionMode:d=!1}){let[h,i]=(0,c.useState)([]),[j,k]=(0,c.useState)(!0),[m,n]=(0,c.useState)({type:"",search:"",tag:""}),[o,q]=(0,c.useState)({total:0,limit:20,offset:0,hasMore:!1}),[r,s]=(0,c.useState)(null),[t,v]=(0,c.useState)(!1),[w,x]=(0,c.useState)(!1),y=(0,c.useCallback)(async(a=!1,b)=>{k(!0);try{let c=new URLSearchParams;m.type&&c.append("type",m.type),m.search&&c.append("search",m.search),m.tag&&c.append("tag",m.tag);let d=b??(a?0:o.offset);c.append("limit",o.limit.toString()),c.append("offset",d.toString());let e=await fetch(`/api/media?${c.toString()}`),f=await e.json();a?i(f.media):i(a=>[...a,...f.media]),q(f.pagination)}catch(a){console.error("Error fetching media:",a)}finally{k(!1)}},[m,o.limit,o.offset]);(0,c.useEffect)(()=>{y(!0)},[y]);let z=async(a,b)=>{let c=await fetch(`/api/media/${a}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify(b)});if(c.ok){let b=await c.json();i(c=>c.map(c=>c.id===a?b:c))}},A=async a=>{(await fetch(`/api/media/${a}`,{method:"DELETE"})).ok&&(i(b=>b.filter(b=>b.id!==a)),v(!1))},B=async()=>{x(!0);try{let a=await fetch("/api/media/sync",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({})}),b=await a.json();a.ok?(alert(`Synchronisation termin\xe9e : ${b.added} ajout\xe9s, ${b.skipped} ignor\xe9s.`),y(!0)):alert("Erreur lors de la synchronisation")}catch(a){console.error("Error syncing:",a),alert("Erreur lors de la synchronisation")}finally{x(!1)}};return(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsxs)("div",{className:"flex flex-col md:flex-row gap-4 justify-between items-start md:items-center bg-white dark:bg-gray-800 p-4 rounded-lg shadow-sm",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2 w-full md:w-auto",children:[(0,b.jsxs)("div",{className:"relative flex-1 md:w-64",children:[(0,b.jsx)(e,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400",size:18}),(0,b.jsx)("input",{type:"text",placeholder:"Rechercher...",value:m.search,onChange:a=>n({...m,search:a.target.value}),className:"w-full pl-10 pr-4 py-2 border rounded-md dark:bg-gray-700 dark:border-gray-600 dark:text-white focus:ring-2 focus:ring-blue-500"})]}),(0,b.jsxs)("select",{value:m.type,onChange:a=>n({...m,type:a.target.value}),className:"px-3 py-2 border rounded-md dark:bg-gray-700 dark:border-gray-600 dark:text-white focus:ring-2 focus:ring-blue-500",children:[(0,b.jsx)("option",{value:"",children:"Tous les types"}),(0,b.jsx)("option",{value:"image",children:"Images"}),(0,b.jsx)("option",{value:"video",children:"Vidéos"}),(0,b.jsx)("option",{value:"document",children:"Documents"})]})]}),(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsxs)("button",{onClick:B,disabled:w,className:"flex items-center gap-2 px-3 py-2 bg-blue-50 text-blue-600 rounded-md hover:bg-blue-100 transition-colors disabled:opacity-50",title:"Synchroniser avec le storage",children:[(0,b.jsx)(g,{size:20,className:w?"animate-bounce":""}),(0,b.jsx)("span",{className:"hidden sm:inline",children:"Sync"})]}),(0,b.jsx)("button",{onClick:()=>y(!0),className:"p-2 text-gray-500 hover:text-blue-600 transition-colors",title:"Rafraîchir",children:(0,b.jsx)(f,{size:20})})]})]}),!d&&(0,b.jsx)(p,{onUploadComplete:a=>{i(b=>[a,...b])}}),j&&0===h.length?(0,b.jsx)("div",{className:"flex justify-center py-12",children:(0,b.jsx)(f,{className:"animate-spin text-blue-500",size:32})}):h.length>0?(0,b.jsx)("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 gap-4",children:h.map(c=>(0,b.jsx)(l,{media:c,onClick:b=>{d&&a?a(b):(s(b),v(!0))}},c.id))}):(0,b.jsx)("div",{className:"text-center py-12 text-gray-500 dark:text-gray-400",children:"Aucun média trouvé"}),o.hasMore&&(0,b.jsx)("div",{className:"flex justify-center pt-4",children:(0,b.jsx)("button",{onClick:()=>{o.hasMore&&y(!1,o.offset+o.limit)},disabled:j,className:"px-6 py-2 bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-200 rounded-md hover:bg-gray-200 dark:hover:bg-gray-600 transition-colors disabled:opacity-50",children:j?"Chargement...":"Charger plus"})}),r&&(0,b.jsx)(u,{media:r,isOpen:t,onClose:()=>v(!1),onUpdate:z,onDelete:A})]})}a.s(["default",()=>v],85630)}];

//# sourceMappingURL=apps_web_components_media_MediaGallery_tsx_28bcb1c6._.js.map